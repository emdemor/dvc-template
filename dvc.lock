schema: '2.0'
stages:
  data_load:
    cmd: python src/data_load.py --config=params.yaml
    deps:
    - path: data/imoveis_pocos.csv
      md5: 6fa699df52c4baaa1f31d23f24d310cc
      size: 101157
    - path: src/data_load.py
      md5: df5a24306dbb05336cd071c57b52ca6f
      size: 746
    params:
      params.yaml:
        data_load:
          raw_data_path: data/imoveis_pocos.csv
    outs:
    - path: pkl/raw_data.pkl
      md5: a7cd955eed8afdb0c6689db1510206ed
      size: 149972
  feature_transform:
    cmd: python src/feature_transform.py --config=params.yaml
    deps:
    - path: pkl/raw_data.pkl
      md5: a7cd955eed8afdb0c6689db1510206ed
      size: 149972
    - path: src/feature_transform.py
      md5: 9f284fda51fdb2f793f43d65294b66d1
      size: 2745
    params:
      params.yaml:
        feature_transform:
          log_target: true
          features:
          - dormitorios
          - banheiros
          - vagas_na_garagem
          - area_terreno
          - area_util
          - condominio
          - torres
          - portaria_hrs
          - elevador_social
          - suites
          - apartamento_por_andar
          - quantidade_de_andares
          - elevador_de_servico
          - salao_de_festa
          - iptu
          - lat
          - long
          - dist_centro
          features_to_encode: []
    outs:
    - path: pkl/features.pkl
      md5: ba41e42200fc012cfc96e06f9afb8d2b
      size: 141515
    - path: pkl/targets.pkl
      md5: 69383daf9dd2ab159865f2a9f60e0a97
      size: 22862
  splitting:
    cmd: python src/splitting.py --config=params.yaml
    deps:
    - path: pkl/features.pkl
      md5: ba41e42200fc012cfc96e06f9afb8d2b
      size: 141515
    - path: pkl/targets.pkl
      md5: 69383daf9dd2ab159865f2a9f60e0a97
      size: 22862
    - path: src/splitting.py
      md5: 4341f8cc019bf5f635c7b9f705f51947
      size: 1594
    params:
      params.yaml:
        splitting:
          test_size: 0.25
          random_state: 42
    outs:
    - path: pkl/features_test.pkl
      md5: 3e67f6ac06fe427d16d14dd7173b59d3
      size: 36168
    - path: pkl/features_train.pkl
      md5: aa0057c79ab993a6ed4edf91e72c6d24
      size: 106403
    - path: pkl/targets_test.pkl
      md5: adc396de6128e296c0fa877fd178402a
      size: 6226
    - path: pkl/targets_train.pkl
      md5: 6de404eff758ba10592c613becc13c3d
      size: 17318
  model_training:
    cmd: python src/model_training.py --config=params.yaml
    deps:
    - path: pkl/features_train.pkl
      md5: aa0057c79ab993a6ed4edf91e72c6d24
      size: 106403
    - path: pkl/targets_train.pkl
      md5: 6de404eff758ba10592c613becc13c3d
      size: 17318
    - path: src/model_training.py
      md5: 123e1073b214fdb9e2e4fd9ce3671421
      size: 1400
    params:
      params.yaml:
        model:
          regressor: GradientBoostingRegressor
          loss: huber
          random_state: 42
          n_estimators: 3000
          alpha: 0.95
    outs:
    - path: pkl/model.pkl
      md5: 48dd20648c6b282373f3d3d213517116
      size: 3457837
  model_testing:
    cmd: python src/model_testing.py --config=params.yaml
    deps:
    - path: pkl/features_test.pkl
      md5: 3e67f6ac06fe427d16d14dd7173b59d3
      size: 36168
    - path: pkl/model.pkl
      md5: 48dd20648c6b282373f3d3d213517116
      size: 3457837
    - path: pkl/targets_test.pkl
      md5: adc396de6128e296c0fa877fd178402a
      size: 6226
    - path: src/model_testing.py
      md5: 0485292e39480653deb0caa20a3259e4
      size: 1449
    params:
      params.yaml:
        test:
          mean_absolute_error: true
          r2_score: true
    outs:
    - path: data/metrics.csv
      md5: 8075ba14f8708b1852f2c055efd27822
      size: 71
